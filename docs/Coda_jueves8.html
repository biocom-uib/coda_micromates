<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CODA para estudios del microbioma Seminario para protecto METACIRCLE XXXX - 1&nbsp; Todo</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Todo</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">CODA para estudios del microbioma Seminario para protecto METACIRCLE XXXX</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introducción 👋</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Coda_jueves8.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Todo</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción"><span class="toc-section-number">1.1</span>  Introducción 👋</a>
  <ul class="collapse">
  <li><a href="#objetivos-del-seminario" id="toc-objetivos-del-seminario" class="nav-link" data-scroll-target="#objetivos-del-seminario"><span class="toc-section-number">1.1.1</span>  Objetivos del seminario 🎯</a></li>
  </ul></li>
  <li><a href="#los-datos-de-secuenciación-son-composicionales" id="toc-los-datos-de-secuenciación-son-composicionales" class="nav-link" data-scroll-target="#los-datos-de-secuenciación-son-composicionales"><span class="toc-section-number">1.2</span>  1. Los datos de secuenciación son composicionales 🤯</a></li>
  <li><a href="#problemas-que-surgen-cuando-no-se-utiliza-el-paradigma-composicional" id="toc-problemas-que-surgen-cuando-no-se-utiliza-el-paradigma-composicional" class="nav-link" data-scroll-target="#problemas-que-surgen-cuando-no-se-utiliza-el-paradigma-composicional"><span class="toc-section-number">1.3</span>  2. Problemas que surgen cuando no se utiliza el paradigma composicional 😵</a></li>
  <li><a href="#principios-básicos-del-coda" id="toc-principios-básicos-del-coda" class="nav-link" data-scroll-target="#principios-básicos-del-coda"><span class="toc-section-number">1.4</span>  3. Principios básicos del CODA</a></li>
  <li><a href="#reemplazos-composicionales-del-tool-kit-tradicional" id="toc-reemplazos-composicionales-del-tool-kit-tradicional" class="nav-link" data-scroll-target="#reemplazos-composicionales-del-tool-kit-tradicional"><span class="toc-section-number">1.5</span>  3. Reemplazos composicionales del <code>tool kit</code> tradicional 👀</a></li>
  <li><a href="#coda-en-acción" id="toc-coda-en-acción" class="nav-link" data-scroll-target="#coda-en-acción"><span class="toc-section-number">1.6</span>  4. CODA en acción 😎</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Todo</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>lkvffñsldkñ</p>
<section id="introducción" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="introducción"><span class="header-section-number">1.1</span> Introducción 👋</h2>
<ul>
<li><p>Los estudios sobre el microbioma humano se enmarcan en el ámbito de los datos de composición, ya que <font color="blue"> las abundancias absolutas de microorganismos no pueden obtenerse a partir de los datos de secuenciación</font>.</p></li>
<li><p>Cada muestra consiste en proporciones de varios microrganismos con una suma limitada a una constante. Esta simple característica hace que <font color="blue"> los tratamientos estadísticos tradicionales lleven a resultados erróneos y correlaciones espurias</font>.</p></li>
</ul>
<section id="objetivos-del-seminario" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="objetivos-del-seminario"><span class="header-section-number">1.1.1</span> Objetivos del seminario 🎯</h3>
<p><em>i.- Discutiremos los <code>orígenes</code> de la composicionalidad en los datos del microbioma.</em></p>
<p><em>ii.- Mostraremos los principales <code>problemas</code> de utilizar los métodos estadísticos tradicionales para tratar los datos de secuenciación.</em></p>
<p><em>iii.- Indicaremos los reemplazos composicionales de las técnicas del <code>tool kit</code> de análisis de datos de microbioma.</em></p>
<p><em>iv.- <code>CODA en acción</code>: trabajaremos con un ejemplo de datos de la microbiota humana, veremos el tipo de resultados que podemos obtener.</em></p>
</section>
</section>
<section id="los-datos-de-secuenciación-son-composicionales" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="los-datos-de-secuenciación-son-composicionales"><span class="header-section-number">1.2</span> 1. Los datos de secuenciación son composicionales 🤯</h2>
<p><img src="images/frontiers.PNG" class="img-fluid"></p>
<ul>
<li><p>Los datos obtenidos después de la secuenciación no son equivalentes a los <span class="cross">datos ecológicos</span>.</p></li>
<li><p>En un estudio ecológico es posible que coexistan muchas especies diferentes y su abundacia absoluta puede ser importante.</p></li>
</ul>
<p>En los datos de secuenciación de alto rendimiento (<span class="highlight">HTS</span> ):</p>
<ul>
<li><font color="red"> El número de lecturas <strong>no</strong> representa la abundancia total o absoluta en el ecosistema</font>. El secuenciador solo puede proporcionar <span class="highlight">lecturas hasta su capacidad</span>.</li>
</ul>
<center>
<img src="images/poblacion.PNG" class="img-fluid">
</center>
<p><br></p>
<ul>
<li><p><strong>La frecuencia de lecturas observadas en un experimento de HTS es una muestra aleatoria de tamaño fijo de la abundancia relativa de las moléculas en el ecosistema subyacente</strong>.</p></li>
<li><p>Esto se reconoce implícitamente cuando los datos del microbioma se convierten en valores de abundancia relativa o conteos normalizados,o se “enrarecen” (rarefying). <font color="blue">Ninguno de estos enfoques corrige la la composicionalidad </font></p></li>
</ul>
<p><br></p>
<div class="box">
<p class="text-danger">
</p><p><font color="red">Los datos que se describen de forma natural como proporciones o probabilidades, o con una suma constante o irrelevante, se denominan datos composicionales.</font></p><font color="red">
</font><p><font color="red"><strong>Los datos de composición contienen información sobre las relaciones entre las partes.</strong> </font></p>
<p></p>
</div>
<p><br> Podemos ver la diferencia entre conteos y proporciones comparando los datos de tres muestras en el gráfico que se presenta a continuación.</p>
<ul>
<li>Los diagramas de barras que se presentan a continuación muestran la diferencia entre el conteo de moléculas y la proporción de moléculas para dos características, A y B en tres muestras.</li>
</ul>
<center>
<img src="images/abundancias_relativas.PNG" class="img-fluid">
</center>
<p>Observa que las muestras 2 y 3 tienen las mismas abundancias proporcionales, aunque tengan conteos absolutos diferentes antes de la secuenciación.</p>
<p>En la tabla podemos observar que la relación entre la abundancia absoluta y la abundancia relativa cambia de manera significativa.</p>
</section>
<section id="problemas-que-surgen-cuando-no-se-utiliza-el-paradigma-composicional" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="problemas-que-surgen-cuando-no-se-utiliza-el-paradigma-composicional"><span class="header-section-number">1.3</span> 2. Problemas que surgen cuando no se utiliza el paradigma composicional 😵</h2>
<p><br></p>
<ol type="a">
<li><span class="highlight">Trabajar con proporciones induce correlación espuria</span> (Pearson 1896).</li>
</ol>
<p>Dos o más OTUs estarán correlacionados simplemente porque los datos han sido transformados a una suma constante.</p>
<center>
<img src="images/espuria.PNG" class="img-fluid">
</center>
<p><br></p>
<ol start="2" type="a">
<li><span class="highlight">Trabajar con proporciones induce incoherencia subcomposicional</span></li>
</ol>
<center>
<img src="images/subcomposicion.PNG" class="img-fluid">
</center>
<p><br></p>
<p>No importa el tipo de correlación: Spearman, Pearson, etc</p>
<center>
<img src="images/tipos_correlacion.PNG" class="img-fluid">
</center>
<p><br></p>
<div class="box">
<p class="text-danger">
</p><p><font color="red"> Comprender que existe un problema de correlación es importante porque ésta juega un rol fundamental en las técnicas clásicas de análisis de datos multivariantes como clustering, MDS, network analysis. </font></p>
<p></p>
</div>
<p><br></p>
<ol start="2" type="a">
<li><span class="highlight">Matrices de distancia o dissimilaridad después de la normalización no toman en cuenta la naturaleza composicional de los datos</span></li>
</ol>
<ul>
<li><p>El número total de recuentos observados (a menudo denominado como profundidad de lectura) es un factor de confusión importante para los cálculos de distancia o disimilitud.</p></li>
<li><p>Los primeros intentos en el campo del microbioma utilizaron la “rarefacción” o el submuestreo de cada muestra a una profundidad de lectura común para intentar corregir este problema. El uso del submuestreo resulta en una pérdida de información y precisión.</p></li>
<li><p>La normalización de recuentos se ha utilizado y existen varios métodos: la media truncada (TMM) y el método de la mediana. Ambos son similares a las transformaciones de un log-ratios, pero son menos adecuados en conjuntos de datos muy asimétricos o dispersos.</p></li>
<li><p>Estas transformaciones son además indeseables, ya que el número de recuentos observados por el instrumento, por diseño, no puede contener ninguna información sobre el número real de moléculas en el entorno, y porque el investigador interpreta los resultados como recuentos en lugar de relaciones logarítmicas.</p></li>
</ul>
<center>
<img src="images/nature.PNG" class="img-fluid">
</center>
<p><br></p>
<p><strong>Distribución de las tasas de falsos positivos en réplicas simuladas de datos transformados y no transformados</strong> (Nearing et al.&nbsp;Nat.Comm 2022)</p>
<center>
<img src="images/FP.PNG" class="img-fluid">
</center>
</section>
<section id="principios-básicos-del-coda" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="principios-básicos-del-coda"><span class="header-section-number">1.4</span> 3. Principios básicos del CODA</h2>
</section>
<section id="reemplazos-composicionales-del-tool-kit-tradicional" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="reemplazos-composicionales-del-tool-kit-tradicional"><span class="header-section-number">1.5</span> 3. Reemplazos composicionales del <code>tool kit</code> tradicional 👀</h2>
<br>
<center>
<img src="images/tecnicas_AD.PNG" class="img-fluid">
</center>
<p><br></p>
</section>
<section id="coda-en-acción" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="coda-en-acción"><span class="header-section-number">1.6</span> 4. CODA en acción 😎</h2>
<!-- Hasta aquí -->
<p>You can also <span class="strike">strike through</span>, <span class="cross">cross-off</span>, <span class="highlight">highlight</span>, and <span class="circle">circle</span> text</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introducción 👋</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>